SubDir HAIKU_TOP src system boot platform virt arch riscv64 ;

SubDirHdrs $(HAIKU_TOP) src system boot platform virt ;

UseLibraryHeaders [ FDirName libfdt ] ;

UsePrivateHeaders [ FDirName kernel platform ] ;
UsePrivateHeaders [ FDirName kernel boot arch riscv64 ] ;
UsePrivateHeaders [ FDirName kernel boot platform virt ] ;

local platform ;
for platform in [ MultiBootSubDirSetup virt ] {
    on $(platform) {
	{
		local defines = _BOOT_MODE ;
		defines = [ FDefines $(defines) ] ;
		SubDirCcFlags $(defines) ;
		SubDirC++Flags $(defines) -fno-rtti ;
	}

	local arch_src =
		crt0-virt-riscv64.S
		entry.S
		arch_dtb.cpp
		arch_mmu.cpp
		arch_start.cpp
		;

	BootMergeObject boot_platform_virt_riscv64.o :
		$(arch_src)
		;
	}
}
